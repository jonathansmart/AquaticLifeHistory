<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maturity estimation for aquatic species through the AquaticLifeHistory package • AquaticLifeHistory</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Maturity estimation for aquatic species through the AquaticLifeHistory package">
<meta property="og:description" content="AquaticLifeHistory">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AquaticLifeHistory</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Growth_estimation.html">Growth estimation example using the AquaticLifeHistory package</a>
    </li>
    <li>
      <a href="../articles/Maturity_analyses.html">Maturity estimation for aquatic species through the AquaticLifeHistory package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jonathansmart/AquaticLifeHistory/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Maturity estimation for aquatic species through
the AquaticLifeHistory package</h1>
                        <h4 data-toc-skip class="author">Jonathan
Smart</h4>
            
            <h4 data-toc-skip class="date">2023-11-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonathansmart/AquaticLifeHistory/blob/HEAD/vignettes/Maturity_analyses.Rmd" class="external-link"><code>vignettes/Maturity_analyses.Rmd</code></a></small>
      <div class="hidden name"><code>Maturity_analyses.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Please cite this package if it is used in any publication. The
citation details can be accessed in the command line:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"AquaticLifeHistory"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite AquaticLifeHistory use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Smart J 2023 AquaticLifeHistory: Fisheries life history analysis</span></span>
<span><span class="co">#&gt;   using contemporary methods.</span></span>
<span><span class="co">#&gt;   https://github.com/jonathansmart/AquaticLifeHistory</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Smart, J. J., Chin, A. , Tobin, A. J. and Simpfendorfer, C. A. (2016)</span></span>
<span><span class="co">#&gt;   Multimodel approaches in shark and ray growth studies: strengths,</span></span>
<span><span class="co">#&gt;   weaknesses and the future. Fish and Fisheries, 17: 955-971.</span></span>
<span><span class="co">#&gt;   doi:10.1111/faf.12154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span></span>
<span><span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span></span>
<span><span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Maturity estimation is performed by fitting a maturity ogive to
binary maturity statuses for either length or age data. Maturity ogives
are fitted using a glm with a logit link function and usually with a
binomial error structure (but we’ll touch on this soon). A glm of this
sort is fitted in R using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Maturity</span><span class="op">~</span><span class="va">Age</span>,data <span class="op">=</span> <span class="va">my.data</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></code></pre></div>
<p>The default link function for a binomial error structure is the logit
link function. Therefore this does not need to be specified.</p>
<p>All maturity analyses using a logistic ogive are fitted in this
manner and this is the basic operation occurring in all the maturity
functions in the <code>AquaticLifeHistory</code> package. However,
getting all of the information needed to produce analyses for
publication can involve several steps with a few different decisions
needed. Therefore the <code>Estimate_Age_Maturity</code> and
<code>Estimate_Len_Maturity</code> functions handle much of these
additional steps. However, it is important for the user to understand
that these are basically wrapper functions around a glm call. As such
the analyses inside these functions are simple to implement outside of
this package.</p>
<p>The <code>Estimate_Age_Maturity</code> and
<code>Estimate_Len_Maturity</code> functions perform the following:</p>
<ul>
<li>Estimate the length or age at 50% (<span class="math inline">\(L_{50}\)</span> or <span class="math inline">\(A_{50}\)</span> ) and 95% (<span class="math inline">\(L_{95}\)</span> or <span class="math inline">\(A_{95}\)</span>) maturity with standard errors.
Standard errors are important outputs and should always be reported for
parameters.</li>
<li>Bootstrap the data with a specified number of iterations to produce
95% confidence intervals about the curve</li>
<li>Produce a plot of either:
<ul>
<li>A standard logistic ogive with a binomial error structure. This is
fit to binary data.</li>
<li>A binned logistic ogive with a quasi binomial error structure. This
is fit to proportion mature data for specified length or age bins. These
bins are created inside the function using a specified bin width.</li>
</ul>
</li>
<li>Return the parameter estimates, plots of the maturity ogive or the
predicted ogive fits with bootstrapped estimates for the user to produce
their own plots (recommended if the outputs are meant for
publication).</li>
</ul>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The input data for both <code>Estimate_Age_Maturity</code> and
<code>Estimate_Len_Maturity</code> functions require an age or length
variable as well as a binary maturity variable. These functions accept
various column headings for flexibility. For example
<code>Estimate_Len_Maturity</code> will accept a column named “Length”,
“Len”, “STL”, “TL”, “LT” or “size” (plus others) as the input column for
the length variable. However, the maturity and age columns must have
names that begin with “mat” and “age”, respectively. The variable names
needed by the functions are <strong>not</strong> case sensitive.</p>
<p>A data set for female silky sharks (<em>Carcharhinus
falciformis</em>) from Papua New Guinea is included as example data.
This shows the typical format accepted by both functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonathansmart/AquaticLifeHistory" class="external-link">AquaticLifeHistory</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"maturity_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Tag Age Length Maturity</span></span>
<span><span class="co">#&gt; 1 10001  12    178        0</span></span>
<span><span class="co">#&gt; 2 10004  10    165        0</span></span>
<span><span class="co">#&gt; 3 10011   9    140        0</span></span>
<span><span class="co">#&gt; 4 10013   8    144        0</span></span>
<span><span class="co">#&gt; 5 10016   0     91        0</span></span>
<span><span class="co">#&gt; 6 10019  10    158        0</span></span>
<span></span>
<span><span class="co"># Maturity variable is binary (immature = 0, mature = 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">$</span><span class="va">Maturity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-estimate_age_maturity">Using <code>Estimate_Age_Maturity</code><a class="anchor" aria-label="anchor" href="#using-estimate_age_maturity"></a>
</h2>
<p>Both maturity functions produce very similar outputs based on either
age or length data. They are built to handle the same data set so there
is no need to subset your data for just length or age. Each function
will identify the variables it needs and will ignore the others.</p>
<p>The <code>Estimate_Age_Maturity</code> function unsurprisingly
estimates age-at-maturity. In doing so it gives you a choice of
model:</p>
<ul>
<li>Binomial model fitted to binary data</li>
<li>Quasi binomial model fitted to binned proportion mature data</li>
</ul>
<p>The input data is the same for both as the age bins are handled
automatically.</p>
<div class="section level3">
<h3 id="binomial-model">Binomial model<a class="anchor" aria-label="anchor" href="#binomial-model"></a>
</h3>
<p>The default call to <code>Estimate_Age_Maturity</code> will return
your parameters with their standard errors (which you should
<strong>ALWAYS</strong> report). The SE’s are the asymptotic errors from
the logistic ogive</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">)</span></span></code></pre></div>
<p>However, if you would like to get a little more out of this function,
you can have it return a plot with bootstrapped confidence intervals
around the curve</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>, return <span class="op">=</span> <span class="st">"plot"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a binomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/bootstrapped2-1.png" width="672"></p>
<p>This is a standard logistic ogive with a binomial error structure
that has been fitted to binary data. The blue line is the predicted
maturity ogive over the age range of the species, the black point marks
the length-at-50%-mature and the grey shading shows the bootstrapped 95%
confidence intervals.</p>
<p>Additionally, you can display the binary data by setting
<code>display.points = TRUE</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>, return <span class="op">=</span> <span class="st">"plot"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span>, display.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a binomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/with%20points%20bootstrapped2-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="quasibinomial-binned-model">Quasibinomial (binned) model<a class="anchor" aria-label="anchor" href="#quasibinomial-binned-model"></a>
</h3>
<p>An alternative approach is to bin the data by age class and determine
the proportion mature in each age class. This is performed by selecting
<code>error.structure = "quasibinomial"</code>. Within the function, the
binary data is binned by age and the model is fitted with the quasi
binomial structure with each age bin weighted by its sample size. Doing
so often returns similar parameter estimates:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>, error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span><span class="op">)</span></span></code></pre></div>
<p>However, a different plot is returned with stacked bars showing the
proportion mature. The sample size of each bin is displayed above
it.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>, return <span class="op">=</span> <span class="st">"plot"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span>, error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a quasibinomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/quasi%20age%20plot2-1.png" width="672"></p>
<p>With regards to age - both logistic model options return almost
identical ogives. Therefore, the decision of which to use is up to the
user.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-estimate_len_maturity">Using <code>Estimate_Len_Maturity</code><a class="anchor" aria-label="anchor" href="#using-estimate_len_maturity"></a>
</h2>
<p>Estimating length-at-maturity is handled the same as age was
previously but with its own function. All of the arguments are the same
with one exception (which we’ll get to shortly).</p>
<p>You can get the parameters:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">)</span></span></code></pre></div>
<p>A plot of the binomial model with the the option of displaying the
points</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>, return <span class="op">=</span> <span class="st">"plot"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span>, display.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a binomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/bootstrapped%20length2-1.png" width="672"></p>
<p>As the length unit can differ between data sets, the function
determines whether cm or mm are being used and will adjust the axis as
needed.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="va">maturity_data</span></span>
<span><span class="va">new_data</span><span class="op">$</span><span class="va">Length</span> <span class="op">&lt;-</span> <span class="va">new_data</span><span class="op">$</span><span class="va">Length</span><span class="op">*</span><span class="fl">10</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">new_data</span>, return <span class="op">=</span> <span class="st">"plot"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span>, display.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a binomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/length%20unit%20changed2-1.png" width="672"></p>
<div class="section level3">
<h3 id="quasibinomial-binned-model-1">Quasibinomial (binned) model<a class="anchor" aria-label="anchor" href="#quasibinomial-binned-model-1"></a>
</h3>
<p>An additional argument is needed to use a quasi binomial model.
Previously, we binned age by year class as there is no other sensible
way to go about this. However, for length the bin width needs to be
specified and this is very important. This is done using the
<code>bin.width</code> argument.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                      return <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>                      n.bootstraps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                      error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span>,</span>
<span>                      bin.width <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a quasibinomial error structure</span></span></code></pre>
<p><img src="Maturity_analyses_files/figure-html/bin%20width2-1.png" width="768"></p>
<p>Note that because now we have to chose the bin width, this can
influence results:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Binomial model</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Length in 10 cm bins</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                      error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span>,</span>
<span>                      bin.width <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Length in 25 cm bins</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                      error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span>,</span>
<span>                      bin.width <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Length in 30 cm bins</span></span>
<span><span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                      error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span>,</span>
<span>                      bin.width <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p>In each instance the <span class="math inline">\(L_{50}\)</span>
changed which means that judicious choice of length bin is needed.
Therefore, I usually advocate that for length-at-maturity you should
used a binomial model with binary data as this avoids introducing
potential bias. It should be noted that this is only an issue for length
as binning data for age does not require decisions on bin width and
therefore avoids biasing the results.</p>
<p>Therefore, if you plan on binning length data make sure you think
things through carefully.</p>
</div>
</div>
<div class="section level2">
<h2 id="retrieving-logistic-model-estimates">Retrieving logistic model estimates<a class="anchor" aria-label="anchor" href="#retrieving-logistic-model-estimates"></a>
</h2>
<p>When producing outputs for publication, you should always aspire to
create their own outputs. The figures produced by this function are
publication quality but are intended to provide guidance and assistance
rather than the final figures. To enable one to produce their own plots,
the results of the maturity ogive and their 95% confidence intervals can
be extracted instead of the plot. This works the same for both functions
with either logistic model.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># selecting return = "plot" returns a ggplot object rather than the parameters.</span></span>
<span><span class="va">Mat_at_age_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Estimate_Age_Maturity.html">Estimate_Age_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                                              return <span class="op">=</span> <span class="st">"estimates"</span>,</span>
<span>                                              n.bootstraps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                              error.structure <span class="op">=</span> <span class="st">"quasibinomial"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Mat_at_len_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Estimate_Len_Maturity.html">Estimate_Len_Maturity</a></span><span class="op">(</span><span class="va">maturity_data</span>,</span>
<span>                                              return <span class="op">=</span> <span class="st">"estimates"</span>,</span>
<span>                                              n.bootstraps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                              error.structure <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Mat_at_age_estimates</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Mat_at_len_estimates</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Bootstrapping logistic model with a quasibinomial error structure</span></span>
<span><span class="co">#&gt; Bootstrapping logistic model with a binomial error structure</span></span>
<span><span class="co">#&gt;    Age     Estimate         high          low</span></span>
<span><span class="co">#&gt; 1 0.00 1.240623e-07 4.166579e-10 5.363830e-06</span></span>
<span><span class="co">#&gt; 2 0.01 1.254845e-07 4.227835e-10 5.411029e-06</span></span>
<span><span class="co">#&gt; 3 0.02 1.269231e-07 4.289993e-10 5.458645e-06</span></span>
<span><span class="co">#&gt; 4 0.03 1.283781e-07 4.353064e-10 5.506680e-06</span></span>
<span><span class="co">#&gt; 5 0.04 1.298498e-07 4.417063e-10 5.555137e-06</span></span>
<span><span class="co">#&gt; 6 0.05 1.313384e-07 4.482002e-10 5.604022e-06</span></span>
<span><span class="co">#&gt;   Length     Estimate         high          low</span></span>
<span><span class="co">#&gt; 1   0.00 2.220446e-16 2.220446e-16 2.220446e-16</span></span>
<span><span class="co">#&gt; 2   0.01 2.220446e-16 2.220446e-16 2.220446e-16</span></span>
<span><span class="co">#&gt; 3   0.02 2.220446e-16 2.220446e-16 2.220446e-16</span></span>
<span><span class="co">#&gt; 4   0.03 2.220446e-16 2.220446e-16 2.220446e-16</span></span>
<span><span class="co">#&gt; 5   0.04 2.220446e-16 2.220446e-16 2.220446e-16</span></span>
<span><span class="co">#&gt; 6   0.05 2.220446e-16 2.220446e-16 2.220446e-16</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jonathan Smart.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
